<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>InstaPro.ai â€” Seu Instagram Profissional no Piloto AutomÃ¡tico</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0a0a0f;
      --surface: #13131a;
      --surface2: #1c1c27;
      --border: rgba(255,255,255,0.07);
      --accent: #7c5cfc;
      --accent2: #fc5c7d;
      --accent3: #5cf8d4;
      --text: #f0f0f8;
      --muted: #7a7a9a;
      --gold: #ffc75f;
      --radius: 16px;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* â”€â”€ NOISE TEXTURE â”€â”€ */
    body::before {
      content: '';
      position: fixed; inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 0; opacity: .5;
    }

    /* â”€â”€ GRADIENT ORBS â”€â”€ */
    .orb {
      position: fixed; border-radius: 50%;
      filter: blur(120px); pointer-events: none; z-index: 0;
    }
    .orb1 { width: 600px; height: 600px; background: rgba(124,92,252,0.15); top: -200px; left: -200px; }
    .orb2 { width: 500px; height: 500px; background: rgba(252,92,125,0.1); bottom: -150px; right: -100px; }
    .orb3 { width: 400px; height: 400px; background: rgba(92,248,212,0.07); top: 50%; left: 50%; transform: translate(-50%,-50%); }

    /* â”€â”€ LAYOUT â”€â”€ */
    .app { position: relative; z-index: 1; }

    /* â”€â”€ SCREENS â”€â”€ */
    .screen { display: none; min-height: 100vh; }
    .screen.active { display: flex; flex-direction: column; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1 â€” LANDING
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #landing {
      align-items: center; justify-content: center;
      padding: 40px 20px; text-align: center;
    }
    .landing-badge {
      display: inline-flex; align-items: center; gap: 8px;
      background: rgba(124,92,252,0.15); border: 1px solid rgba(124,92,252,0.3);
      border-radius: 999px; padding: 6px 16px; font-size: 13px;
      color: #a78bfa; margin-bottom: 32px;
      animation: fadeUp .6s ease both;
    }
    .landing-badge span { width: 6px; height: 6px; background: var(--accent); border-radius: 50%; animation: pulse 2s infinite; }
    .landing-h1 {
      font-family: 'Syne', sans-serif;
      font-size: clamp(40px, 7vw, 80px);
      font-weight: 800; line-height: 1.05;
      letter-spacing: -2px;
      animation: fadeUp .7s .1s ease both;
    }
    .landing-h1 .grad {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .landing-sub {
      max-width: 560px; margin: 20px auto 0;
      color: var(--muted); font-size: 18px; line-height: 1.6;
      animation: fadeUp .7s .2s ease both;
    }
    .landing-cta {
      display: inline-flex; align-items: center; gap: 10px;
      margin-top: 40px; padding: 16px 36px;
      background: linear-gradient(135deg, var(--accent), #9b6dff);
      border: none; border-radius: 999px; color: #fff;
      font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 700;
      cursor: pointer; transition: transform .2s, box-shadow .2s;
      box-shadow: 0 0 40px rgba(124,92,252,0.4);
      animation: fadeUp .7s .3s ease both;
    }
    .landing-cta:hover { transform: translateY(-2px); box-shadow: 0 0 60px rgba(124,92,252,0.6); }
    .landing-features {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px; max-width: 800px; margin: 60px auto 0; width: 100%;
      animation: fadeUp .7s .4s ease both;
    }
    .feat-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 20px;
      text-align: left; transition: border-color .2s;
    }
    .feat-card:hover { border-color: rgba(124,92,252,0.4); }
    .feat-icon { font-size: 28px; margin-bottom: 10px; }
    .feat-card h3 { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; margin-bottom: 6px; }
    .feat-card p { font-size: 13px; color: var(--muted); line-height: 1.5; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 2 â€” ONBOARDING
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #onboarding {
      align-items: center; justify-content: center;
      padding: 40px 20px;
    }
    .onboard-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 24px; padding: 40px; max-width: 560px; width: 100%;
      animation: fadeUp .5s ease both;
    }
    .step-indicator {
      display: flex; gap: 6px; margin-bottom: 32px;
    }
    .step-dot {
      height: 4px; flex: 1; border-radius: 999px;
      background: var(--surface2); transition: background .3s;
    }
    .step-dot.done { background: var(--accent); }
    .step-dot.active { background: linear-gradient(90deg, var(--accent), var(--accent2)); }
    .onboard-step { display: none; }
    .onboard-step.active { display: block; animation: fadeUp .3s ease both; }
    .onboard-label {
      font-size: 12px; font-weight: 500; color: var(--accent);
      text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;
    }
    .onboard-title {
      font-family: 'Syne', sans-serif; font-size: 26px;
      font-weight: 800; margin-bottom: 8px;
    }
    .onboard-sub { color: var(--muted); font-size: 14px; margin-bottom: 28px; line-height: 1.5; }
    .form-group { margin-bottom: 18px; }
    .form-group label { display: block; font-size: 13px; font-weight: 500; margin-bottom: 8px; color: var(--muted); }
    .form-control {
      width: 100%; background: var(--surface2); border: 1px solid var(--border);
      border-radius: 10px; padding: 12px 16px; color: var(--text);
      font-family: 'DM Sans', sans-serif; font-size: 14px;
      transition: border-color .2s; outline: none;
    }
    .form-control:focus { border-color: var(--accent); }
    .form-control::placeholder { color: var(--muted); }
    select.form-control option { background: #1c1c27; }
    .tag-grid { display: flex; flex-wrap: wrap; gap: 8px; }
    .tag-btn {
      padding: 8px 14px; border-radius: 999px;
      background: var(--surface2); border: 1px solid var(--border);
      color: var(--muted); font-size: 13px; cursor: pointer;
      transition: all .2s;
    }
    .tag-btn.selected {
      background: rgba(124,92,252,0.2); border-color: var(--accent);
      color: var(--accent);
    }
    .btn-primary {
      width: 100%; padding: 14px; border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), #9b6dff);
      border: none; color: #fff; font-family: 'Syne', sans-serif;
      font-size: 15px; font-weight: 700; cursor: pointer;
      transition: opacity .2s, transform .2s;
      margin-top: 8px;
    }
    .btn-primary:hover { opacity: .9; transform: translateY(-1px); }
    .btn-secondary {
      background: transparent; border: 1px solid var(--border);
      color: var(--muted); padding: 10px 20px; border-radius: 10px;
      font-size: 13px; cursor: pointer; transition: border-color .2s;
    }
    .btn-secondary:hover { border-color: var(--muted); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 3 â€” LOADING/ANALYSIS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #analyzing {
      align-items: center; justify-content: center;
      padding: 40px 20px; text-align: center;
    }
    .analyze-ring {
      width: 100px; height: 100px; margin: 0 auto 32px;
      border-radius: 50%;
      border: 3px solid var(--surface2);
      border-top-color: var(--accent);
      border-right-color: var(--accent2);
      animation: spin 1s linear infinite;
    }
    .analyze-title { font-family: 'Syne', sans-serif; font-size: 28px; font-weight: 800; margin-bottom: 12px; }
    .analyze-steps { list-style: none; margin-top: 24px; text-align: left; max-width: 320px; margin-left: auto; margin-right: auto; }
    .analyze-step {
      display: flex; align-items: center; gap: 12px;
      padding: 10px 0; color: var(--muted); font-size: 14px;
      border-bottom: 1px solid var(--border);
      transition: color .3s;
    }
    .analyze-step.done { color: var(--accent3); }
    .analyze-step.active { color: var(--text); }
    .step-check { width: 20px; height: 20px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 11px; flex-shrink: 0; transition: all .3s; }
    .analyze-step.done .step-check { background: var(--accent3); border-color: var(--accent3); color: #000; }
    .analyze-step.active .step-check { border-color: var(--accent); animation: pulse 1s infinite; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 4 â€” DASHBOARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #dashboard { flex-direction: column; }
    .topbar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 32px; border-bottom: 1px solid var(--border);
      background: rgba(10,10,15,0.8); backdrop-filter: blur(20px);
      position: sticky; top: 0; z-index: 100;
    }
    .topbar-logo { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 18px; }
    .topbar-logo span { background: linear-gradient(135deg,var(--accent),var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .topbar-user { display: flex; align-items: center; gap: 12px; }
    .user-avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg,var(--accent),var(--accent2)); display: flex; align-items: center; justify-content: center; font-family: 'Syne',sans-serif; font-weight: 800; font-size: 14px; }
    .dash-body { display: grid; grid-template-columns: 260px 1fr; flex: 1; min-height: 0; }
    .sidebar {
      border-right: 1px solid var(--border); padding: 24px 16px;
      background: rgba(13,13,20,0.5);
    }
    .sidebar-nav { list-style: none; }
    .nav-item {
      display: flex; align-items: center; gap: 12px;
      padding: 10px 14px; border-radius: 10px; cursor: pointer;
      color: var(--muted); font-size: 14px; font-weight: 500;
      transition: all .2s; margin-bottom: 4px;
    }
    .nav-item:hover { background: var(--surface); color: var(--text); }
    .nav-item.active { background: rgba(124,92,252,0.15); color: var(--accent); }
    .nav-icon { font-size: 18px; width: 24px; text-align: center; }
    .sidebar-divider { height: 1px; background: var(--border); margin: 16px 0; }

    /* RANK CARD in sidebar */
    .rank-card {
      background: linear-gradient(135deg, rgba(124,92,252,0.2), rgba(252,92,125,0.1));
      border: 1px solid rgba(124,92,252,0.3);
      border-radius: 14px; padding: 16px; margin-bottom: 20px;
    }
    .rank-label { font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: var(--muted); margin-bottom: 4px; }
    .rank-name { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800; color: var(--gold); margin-bottom: 8px; }
    .xp-bar-wrap { background: rgba(255,255,255,0.1); border-radius: 999px; height: 6px; overflow: hidden; margin-bottom: 6px; }
    .xp-bar { height: 100%; border-radius: 999px; background: linear-gradient(90deg, var(--accent), var(--accent2)); transition: width 1s ease; }
    .xp-text { font-size: 11px; color: var(--muted); }

    /* MAIN CONTENT */
    .main-content { padding: 32px; overflow-y: auto; }
    .main-tab { display: none; }
    .main-tab.active { display: block; animation: fadeUp .3s ease both; }

    /* SCORE CARD */
    .score-hero {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 20px; padding: 32px; margin-bottom: 24px;
      display: grid; grid-template-columns: 1fr auto; gap: 24px; align-items: center;
    }
    .score-title { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; margin-bottom: 8px; }
    .score-sub { color: var(--muted); font-size: 14px; line-height: 1.6; max-width: 480px; }
    .score-ring-wrap { position: relative; width: 120px; height: 120px; flex-shrink: 0; }
    .score-ring { transform: rotate(-90deg); }
    .score-ring circle { fill: none; stroke-width: 8; }
    .score-ring .bg { stroke: var(--surface2); }
    .score-ring .fill { stroke: url(#scoreGrad); stroke-linecap: round; transition: stroke-dashoffset 1.5s ease; }
    .score-num {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
      font-family: 'Syne', sans-serif; font-size: 28px; font-weight: 800; text-align: center;
    }
    .score-num span { display: block; font-size: 10px; font-weight: 400; color: var(--muted); }

    /* METRICS GRID */
    .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px; }
    .metric-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 20px;
    }
    .metric-icon { font-size: 24px; margin-bottom: 8px; }
    .metric-label { font-size: 12px; color: var(--muted); margin-bottom: 4px; }
    .metric-val { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; }
    .metric-badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 11px; font-weight: 600; margin-top: 4px; }
    .badge-red { background: rgba(252,92,125,0.15); color: var(--accent2); }
    .badge-green { background: rgba(92,248,212,0.15); color: var(--accent3); }
    .badge-yellow { background: rgba(255,199,95,0.15); color: var(--gold); }

    /* TIPS */
    .tips-list { display: flex; flex-direction: column; gap: 12px; }
    .tip-item {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 16px 20px;
      display: flex; align-items: flex-start; gap: 14px;
      transition: border-color .2s;
    }
    .tip-item:hover { border-color: rgba(124,92,252,0.3); }
    .tip-priority { width: 8px; height: 8px; border-radius: 50%; margin-top: 6px; flex-shrink: 0; }
    .priority-high { background: var(--accent2); }
    .priority-med { background: var(--gold); }
    .priority-low { background: var(--accent3); }
    .tip-title { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700; margin-bottom: 4px; }
    .tip-desc { font-size: 13px; color: var(--muted); line-height: 1.5; }

    /* POSTS TAB */
    .post-generator { background: var(--surface); border: 1px solid var(--border); border-radius: 20px; padding: 28px; margin-bottom: 24px; }
    .gen-title { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 800; margin-bottom: 20px; }
    .gen-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
    .format-options { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
    .format-btn { padding: 8px 16px; border-radius: 999px; border: 1px solid var(--border); background: var(--surface2); color: var(--muted); font-size: 13px; cursor: pointer; transition: all .2s; }
    .format-btn.selected, .format-btn:hover { border-color: var(--accent); color: var(--accent); background: rgba(124,92,252,0.1); }
    .gen-btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 12px 28px; background: linear-gradient(135deg,var(--accent),#9b6dff);
      border: none; border-radius: 10px; color: #fff;
      font-family: 'Syne',sans-serif; font-size: 14px; font-weight: 700;
      cursor: pointer; transition: opacity .2s; width: 100%;
      justify-content: center; font-size: 15px; padding: 14px;
    }
    .gen-btn:hover { opacity: .9; }
    .gen-btn:disabled { opacity: .5; cursor: not-allowed; }

    /* GENERATED POST CARD */
    .post-card {
      background: var(--surface2); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 20px; margin-top: 20px;
      animation: fadeUp .4s ease both;
    }
    .post-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .post-type-badge { padding: 4px 12px; border-radius: 999px; font-size: 12px; font-weight: 600; background: rgba(124,92,252,0.2); color: var(--accent); }
    .post-copy-btn { background: transparent; border: 1px solid var(--border); border-radius: 8px; padding: 6px 12px; color: var(--muted); font-size: 12px; cursor: pointer; transition: all .2s; }
    .post-copy-btn:hover { border-color: var(--accent3); color: var(--accent3); }
    .post-content-area { background: var(--surface); border-radius: 10px; padding: 16px; font-size: 14px; line-height: 1.7; color: var(--text); white-space: pre-wrap; word-break: break-word; }
    .hashtag-cloud { margin-top: 12px; display: flex; flex-wrap: wrap; gap: 6px; }
    .hashtag { padding: 4px 10px; border-radius: 999px; background: rgba(92,248,212,0.1); color: var(--accent3); font-size: 12px; }

    /* RANKING TAB */
    .missions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; }
    .mission-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 20px;
      transition: border-color .2s; cursor: pointer;
    }
    .mission-card:hover { border-color: rgba(124,92,252,0.3); }
    .mission-card.done { border-color: rgba(92,248,212,0.3); background: rgba(92,248,212,0.03); }
    .mission-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
    .mission-icon { font-size: 28px; }
    .mission-xp { font-family: 'Syne',sans-serif; font-size: 13px; font-weight: 700; color: var(--gold); background: rgba(255,199,95,0.1); padding: 3px 10px; border-radius: 999px; }
    .mission-title { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; margin-bottom: 6px; }
    .mission-desc { font-size: 13px; color: var(--muted); line-height: 1.5; margin-bottom: 14px; }
    .mission-check-btn {
      width: 100%; padding: 10px; border-radius: 8px;
      background: transparent; border: 1px solid var(--border);
      color: var(--muted); font-size: 13px; cursor: pointer;
      transition: all .2s;
    }
    .mission-check-btn:hover { border-color: var(--accent); color: var(--accent); }
    .mission-card.done .mission-check-btn { background: rgba(92,248,212,0.1); border-color: var(--accent3); color: var(--accent3); }
    .levels-track { display: flex; gap: 0; overflow-x: auto; padding: 24px 0; margin-bottom: 28px; }
    .level-node { flex-shrink: 0; display: flex; flex-direction: column; align-items: center; width: 120px; }
    .level-circle {
      width: 52px; height: 52px; border-radius: 50%;
      background: var(--surface2); border: 2px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 20px; position: relative; z-index: 1;
      transition: all .3s;
    }
    .level-node.current .level-circle { border-color: var(--accent); box-shadow: 0 0 20px rgba(124,92,252,0.4); background: rgba(124,92,252,0.15); }
    .level-node.done .level-circle { border-color: var(--accent3); background: rgba(92,248,212,0.1); }
    .level-name { font-size: 11px; font-weight: 600; margin-top: 8px; text-align: center; color: var(--muted); }
    .level-node.current .level-name { color: var(--accent); }
    .level-node.done .level-name { color: var(--accent3); }
    .level-connector { flex: 1; height: 2px; background: var(--border); margin-top: 26px; min-width: 20px; }
    .level-connector.done { background: var(--accent3); }

    /* SEO TAB */
    .seo-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; }
    .seo-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 22px;
    }
    .seo-card-icon { font-size: 32px; margin-bottom: 12px; }
    .seo-card-title { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800; margin-bottom: 8px; }
    .seo-card-desc { font-size: 13px; color: var(--muted); line-height: 1.6; margin-bottom: 16px; }
    .seo-keywords { display: flex; flex-wrap: wrap; gap: 6px; }
    .seo-kw { padding: 4px 10px; background: rgba(124,92,252,0.1); border: 1px solid rgba(124,92,252,0.2); border-radius: 999px; font-size: 12px; color: var(--accent); }

    /* TRENDS TAB */
    .trend-item {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 18px 20px; margin-bottom: 12px;
      display: flex; align-items: center; gap: 16px;
    }
    .trend-rank { font-family: 'Syne', sans-serif; font-size: 28px; font-weight: 800; color: var(--surface2); min-width: 40px; }
    .trend-info { flex: 1; }
    .trend-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; margin-bottom: 4px; }
    .trend-desc { font-size: 13px; color: var(--muted); }
    .trend-heat { font-size: 13px; font-weight: 600; color: var(--accent2); white-space: nowrap; }

    /* SETTINGS / API KEY */
    .api-setup {
      background: linear-gradient(135deg, rgba(252,92,125,0.1), rgba(124,92,252,0.1));
      border: 1px solid rgba(252,92,125,0.2);
      border-radius: 20px; padding: 28px; margin-bottom: 24px;
    }
    .api-title { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 800; margin-bottom: 8px; }
    .api-desc { font-size: 14px; color: var(--muted); line-height: 1.6; margin-bottom: 20px; }
    .api-steps { counter-reset: step; }
    .api-step {
      display: flex; align-items: flex-start; gap: 14px;
      padding: 12px 0; border-bottom: 1px solid var(--border);
    }
    .api-step:last-child { border-bottom: none; }
    .api-step-num { width: 28px; height: 28px; border-radius: 50%; background: rgba(124,92,252,0.2); border: 1px solid rgba(124,92,252,0.3); display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-size: 12px; font-weight: 800; color: var(--accent); flex-shrink: 0; }
    .api-step-text { font-size: 13px; line-height: 1.6; padding-top: 4px; }
    .api-step-text a { color: var(--accent); text-decoration: none; }
    .api-step-text a:hover { text-decoration: underline; }
    .api-key-input-wrap { display: flex; gap: 10px; margin-top: 20px; }
    .api-key-input-wrap .form-control { flex: 1; font-family: monospace; }
    .save-api-btn { padding: 12px 20px; background: var(--accent); border: none; border-radius: 10px; color: #fff; font-family: 'Syne', sans-serif; font-weight: 700; font-size: 14px; cursor: pointer; white-space: nowrap; }
    .api-status { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; margin-top: 10px; }
    .status-dot { width: 6px; height: 6px; border-radius: 50%; }
    .status-dot.ok { background: var(--accent3); }
    .status-dot.missing { background: var(--accent2); }

    /* TOAST */
    .toast {
      position: fixed; bottom: 32px; right: 32px; z-index: 999;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 12px; padding: 14px 20px;
      display: flex; align-items: center; gap: 10px;
      font-size: 14px; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      transform: translateY(20px); opacity: 0;
      transition: all .3s ease;
    }
    .toast.show { transform: translateY(0); opacity: 1; }

    /* SECTION HEADER */
    .section-header { margin-bottom: 24px; }
    .section-title { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; margin-bottom: 6px; }
    .section-sub { font-size: 14px; color: var(--muted); }

    /* ANIMATIONS */
    @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: .4; } }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      .dash-body { grid-template-columns: 1fr; }
      .sidebar { display: none; }
      .score-hero { grid-template-columns: 1fr; }
      .gen-grid { grid-template-columns: 1fr; }
      .topbar { padding: 12px 16px; }
      .main-content { padding: 16px; }
      .mobile-nav {
        display: flex; position: fixed; bottom: 0; left: 0; right: 0;
        background: var(--surface); border-top: 1px solid var(--border);
        padding: 8px 16px 20px; gap: 4px; z-index: 100;
      }
    }
    @media (min-width: 769px) { .mobile-nav { display: none; } }
    .mobile-nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 8px 4px; border-radius: 10px; cursor: pointer; color: var(--muted); font-size: 10px; transition: all .2s; background: none; border: none; }
    .mobile-nav-item.active { color: var(--accent); background: rgba(124,92,252,0.1); }
    .mobile-nav-icon { font-size: 20px; }

    /* API KEY warning banner */
    .api-warning {
      background: rgba(252,92,125,0.1); border: 1px solid rgba(252,92,125,0.2);
      border-radius: 12px; padding: 12px 16px; margin-bottom: 20px;
      display: flex; align-items: center; gap: 10px; font-size: 13px;
    }
    .api-warning.hidden { display: none; }
  </style>
</head>
<body>
<div class="orb orb1"></div>
<div class="orb orb2"></div>
<div class="orb orb3"></div>

<div class="app">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1 â€” LANDING
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen active" id="landing">
    <div class="landing-badge"><span></span> LanÃ§amento â€” Acesso Antecipado</div>
    <h1 class="landing-h1">Seu Instagram<br><span class="grad">profissional</span><br>no piloto automÃ¡tico</h1>
    <p class="landing-sub">A IA que analisa seu perfil, cria seus posts, te dÃ¡ missÃµes e te ajuda a virar referÃªncia na sua Ã¡rea â€” sem travar.</p>
    <button class="landing-cta" onclick="goToOnboarding()">
      âœ¦ Analisar meu Instagram
    </button>
    <div class="landing-features">
      <div class="feat-card">
        <div class="feat-icon">ğŸ”</div>
        <h3>DiagnÃ³stico Real</h3>
        <p>Score do seu perfil com pontos exatos de melhoria e prioridades.</p>
      </div>
      <div class="feat-card">
        <div class="feat-icon">âœï¸</div>
        <h3>Posts com IA</h3>
        <p>Legenda completa, hashtags e horÃ¡rio ideal gerados em segundos.</p>
      </div>
      <div class="feat-card">
        <div class="feat-icon">ğŸ®</div>
        <h3>MissÃµes & Ranking</h3>
        <p>Suba de nÃ­vel completando tarefas e veja seu Instagram crescer.</p>
      </div>
      <div class="feat-card">
        <div class="feat-icon">ğŸ”</div>
        <h3>SEO no Google</h3>
        <p>ApareÃ§a nas buscas locais e atraia clientes que jÃ¡ estÃ£o procurando vocÃª.</p>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 2 â€” ONBOARDING
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="onboarding">
    <div class="onboard-card">
      <div class="step-indicator" id="stepIndicator">
        <div class="step-dot active" id="sd1"></div>
        <div class="step-dot" id="sd2"></div>
        <div class="step-dot" id="sd3"></div>
        <div class="step-dot" id="sd4"></div>
      </div>

      <!-- STEP 1 -->
      <div class="onboard-step active" id="step1">
        <div class="onboard-label">Passo 1 de 4</div>
        <div class="onboard-title">Qual Ã© sua profissÃ£o?</div>
        <div class="onboard-sub">Vamos personalizar tudo para a sua Ã¡rea de atuaÃ§Ã£o.</div>
        <div class="form-group">
          <label>ProfissÃ£o</label>
          <select class="form-control" id="profession">
            <option value="">Selecione...</option>
            <option value="advogado">Advogado(a)</option>
            <option value="dentista">Dentista</option>
            <option value="psicologo">PsicÃ³logo(a)</option>
            <option value="nutricionista">Nutricionista</option>
            <option value="medico">MÃ©dico(a)</option>
            <option value="fisioterapeuta">Fisioterapeuta</option>
            <option value="arquiteto">Arquiteto(a)</option>
            <option value="contador">Contador(a)</option>
            <option value="engenheiro">Engenheiro(a)</option>
            <option value="coach">Coach / Mentor</option>
            <option value="outro">Outro</option>
          </select>
        </div>
        <div class="form-group">
          <label>Instagram (ex: @seuuser)</label>
          <input class="form-control" type="text" id="instagram" placeholder="@seuperfil" />
        </div>
        <div class="form-group">
          <label>Cidade / RegiÃ£o</label>
          <input class="form-control" type="text" id="city" placeholder="Ex: SÃ£o Paulo, SP" />
        </div>
        <button class="btn-primary" onclick="nextStep(2)">Continuar â†’</button>
      </div>

      <!-- STEP 2 -->
      <div class="onboard-step" id="step2">
        <div class="onboard-label">Passo 2 de 4</div>
        <div class="onboard-title">Suas Ã¡reas de atuaÃ§Ã£o</div>
        <div class="onboard-sub">Selecione os temas que vocÃª quer abordar no Instagram. Pode escolher vÃ¡rios!</div>
        <div class="tag-grid" id="areasGrid"></div>
        <button class="btn-primary" style="margin-top:24px" onclick="nextStep(3)">Continuar â†’</button>
      </div>

      <!-- STEP 3 -->
      <div class="onboard-step" id="step3">
        <div class="onboard-label">Passo 3 de 4</div>
        <div class="onboard-title">Seu cliente ideal</div>
        <div class="onboard-sub">Isso vai ajudar a IA a criar posts que ressoam com quem vocÃª quer atingir.</div>
        <div class="form-group">
          <label>Faixa etÃ¡ria do cliente</label>
          <select class="form-control" id="clientAge">
            <option value="18-25">18 a 25 anos</option>
            <option value="25-35" selected>25 a 35 anos</option>
            <option value="35-50">35 a 50 anos</option>
            <option value="50+">50 anos ou mais</option>
            <option value="todos">Todos</option>
          </select>
        </div>
        <div class="form-group">
          <label>Principal problema que vocÃª resolve</label>
          <textarea class="form-control" rows="3" id="clientProblem" placeholder="Ex: Meus clientes chegam sem saber seus direitos e com contratos desvantajosos..."></textarea>
        </div>
        <div class="form-group">
          <label>Tom de voz do seu perfil</label>
          <div class="tag-grid" id="toneGrid">
            <div class="tag-btn" onclick="selectTone(this,'educativo')">ğŸ“š Educativo</div>
            <div class="tag-btn" onclick="selectTone(this,'humanizado')">ğŸ’¬ Humanizado</div>
            <div class="tag-btn" onclick="selectTone(this,'autoridade')">ğŸ¯ Autoridade</div>
            <div class="tag-btn" onclick="selectTone(this,'inspirador')">âœ¨ Inspirador</div>
            <div class="tag-btn" onclick="selectTone(this,'descontraido')">ğŸ˜„ DescontraÃ­do</div>
          </div>
        </div>
        <button class="btn-primary" onclick="nextStep(4)">Continuar â†’</button>
      </div>

      <!-- STEP 4 -->
      <div class="onboard-step" id="step4">
        <div class="onboard-label">Passo 4 de 4</div>
        <div class="onboard-title">SituaÃ§Ã£o atual do perfil</div>
        <div class="onboard-sub">Isso ajuda a IA a calibrar o diagnÃ³stico com mais precisÃ£o.</div>
        <div class="form-group">
          <label>Quantos seguidores vocÃª tem hoje?</label>
          <select class="form-control" id="followers">
            <option value="0-100">Menos de 100</option>
            <option value="100-500">100 a 500</option>
            <option value="500-1000">500 a 1.000</option>
            <option value="1000-5000">1.000 a 5.000</option>
            <option value="5000+">Mais de 5.000</option>
          </select>
        </div>
        <div class="form-group">
          <label>Com que frequÃªncia vocÃª posta?</label>
          <select class="form-control" id="frequency">
            <option value="nunca">Nunca / raramente</option>
            <option value="mensal">1-2 vezes por mÃªs</option>
            <option value="semanal">1-2 vezes por semana</option>
            <option value="diario">Quase todos os dias</option>
          </select>
        </div>
        <div class="form-group">
          <label>VocÃª jÃ¡ tem uma bio profissional?</label>
          <div class="tag-grid" id="bioGrid">
            <div class="tag-btn" onclick="selectBio(this,'sim')">âœ… Sim, tenho</div>
            <div class="tag-btn" onclick="selectBio(this,'parcial')">âš ï¸ Mais ou menos</div>
            <div class="tag-btn" onclick="selectBio(this,'nao')">âŒ NÃ£o tenho</div>
          </div>
        </div>
        <button class="btn-primary" onclick="startAnalysis()">ğŸš€ Analisar meu perfil agora</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 3 â€” ANALYZING
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="analyzing">
    <div class="analyze-ring"></div>
    <div class="analyze-title">Analisando seu perfil...</div>
    <p style="color:var(--muted);font-size:14px">Isso vai levar alguns segundos</p>
    <ul class="analyze-steps" id="analyzeSteps">
      <li class="analyze-step active" id="as1"><div class="step-check"></div> Lendo dados do perfil</li>
      <li class="analyze-step" id="as2"><div class="step-check"></div> Avaliando bio e posicionamento</li>
      <li class="analyze-step" id="as3"><div class="step-check"></div> Calculando score de autoridade</li>
      <li class="analyze-step" id="as4"><div class="step-check"></div> Gerando dicas personalizadas</li>
      <li class="analyze-step" id="as5"><div class="step-check"></div> Preparando missÃµes de crescimento</li>
    </ul>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 4 â€” DASHBOARD
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="dashboard">
    <div class="topbar">
      <div class="topbar-logo">Insta<span>Pro.ai</span></div>
      <div class="topbar-user">
        <div style="font-size:13px;color:var(--muted)" id="topbarUser"></div>
        <div class="user-avatar" id="userAvatar">?</div>
      </div>
    </div>
    <div class="dash-body">
      <!-- SIDEBAR -->
      <div class="sidebar">
        <div class="rank-card">
          <div class="rank-label">Seu nÃ­vel atual</div>
          <div class="rank-name" id="sidebarRankName">ğŸŒ± Iniciante</div>
          <div class="xp-bar-wrap"><div class="xp-bar" id="sidebarXpBar" style="width:15%"></div></div>
          <div class="xp-text" id="sidebarXpText">150 / 1000 XP para prÃ³ximo nÃ­vel</div>
        </div>
        <ul class="sidebar-nav">
          <li class="nav-item active" onclick="switchTab('diagnostico',this)"><span class="nav-icon">ğŸ”</span> DiagnÃ³stico</li>
          <li class="nav-item" onclick="switchTab('posts',this)"><span class="nav-icon">âœï¸</span> Criar Posts</li>
          <li class="nav-item" onclick="switchTab('ranking',this)"><span class="nav-icon">ğŸ†</span> MissÃµes & Ranking</li>
          <li class="nav-item" onclick="switchTab('seo',this)"><span class="nav-icon">ğŸ”</span> SEO no Google</li>
          <li class="nav-item" onclick="switchTab('trends',this)"><span class="nav-icon">ğŸ“ˆ</span> TendÃªncias</li>
          <div class="sidebar-divider"></div>
          <li class="nav-item" onclick="switchTab('config',this)"><span class="nav-icon">âš™ï¸</span> Chave de API</li>
        </ul>
      </div>
      <!-- MAIN -->
      <div class="main-content">

        <!-- â”€â”€ DIAGNÃ“STICO â”€â”€ -->
        <div class="main-tab active" id="tab-diagnostico">
          <div class="section-header">
            <div class="section-title">DiagnÃ³stico do Perfil</div>
            <div class="section-sub" id="diagSub">AnÃ¡lise completa do seu Instagram</div>
          </div>
          <div class="api-warning" id="apiWarningDiag">
            âš ï¸ <strong>Configure sua chave de API OpenAI</strong> na aba âš™ï¸ para diagnÃ³sticos com IA real. Agora mostrando anÃ¡lise demonstrativa.
          </div>
          <div class="score-hero">
            <div>
              <div class="score-title" id="scoreTitle">Score de Autoridade</div>
              <p class="score-sub" id="scoreDesc">Seu perfil estÃ¡ em estÃ¡gio inicial. A boa notÃ­cia: com as aÃ§Ãµes certas, vocÃª pode triplicar esse score em 30 dias.</p>
            </div>
            <div class="score-ring-wrap">
              <svg class="score-ring" width="120" height="120" viewBox="0 0 120 120">
                <defs>
                  <linearGradient id="scoreGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#7c5cfc"/>
                    <stop offset="100%" style="stop-color:#fc5c7d"/>
                  </linearGradient>
                </defs>
                <circle class="bg" cx="60" cy="60" r="52" />
                <circle class="fill" id="scoreCircle" cx="60" cy="60" r="52"
                  stroke-dasharray="326.7" stroke-dashoffset="326.7" />
              </svg>
              <div class="score-num" id="scoreNum">0<span>/ 100</span></div>
            </div>
          </div>
          <div class="metrics-grid">
            <div class="metric-card"><div class="metric-icon">ğŸ“</div><div class="metric-label">Bio</div><div class="metric-val" id="metrBio">â€”</div><div class="metric-badge" id="metrBioB"></div></div>
            <div class="metric-card"><div class="metric-icon">ğŸ“…</div><div class="metric-label">FrequÃªncia</div><div class="metric-val" id="metrFreq">â€”</div><div class="metric-badge" id="metrFreqB"></div></div>
            <div class="metric-card"><div class="metric-icon">ğŸ‘¥</div><div class="metric-label">Seguidores</div><div class="metric-val" id="metrFollow">â€”</div><div class="metric-badge" id="metrFollowB"></div></div>
            <div class="metric-card"><div class="metric-icon">ğŸ¯</div><div class="metric-label">Nicho</div><div class="metric-val" id="metrNiche">â€”</div><div class="metric-badge badge-green">âœ“ Definido</div></div>
          </div>
          <div class="section-header" style="margin-top:8px">
            <div class="section-title" style="font-size:18px">ğŸ”§ O que melhorar agora</div>
          </div>
          <div class="tips-list" id="tipsList"></div>
        </div>

        <!-- â”€â”€ POSTS â”€â”€ -->
        <div class="main-tab" id="tab-posts">
          <div class="section-header">
            <div class="section-title">Criar Post com IA</div>
            <div class="section-sub">Gere legendas, hashtags e ideias de conteÃºdo em segundos</div>
          </div>
          <div class="api-warning" id="apiWarningPost">
            âš ï¸ <strong>Configure sua chave de API OpenAI</strong> na aba âš™ï¸ para geraÃ§Ã£o real. Agora mostrando exemplo demonstrativo.
          </div>
          <div class="post-generator">
            <div class="gen-title">âœ¦ Gerador de ConteÃºdo</div>
            <div class="gen-grid">
              <div class="form-group">
                <label>Tema do post</label>
                <input class="form-control" id="postTema" placeholder="Ex: Direitos do consumidor" />
              </div>
              <div class="form-group">
                <label>Objetivo</label>
                <select class="form-control" id="postObjetivo">
                  <option value="educar">Educar / Informar</option>
                  <option value="engajar">Gerar Engajamento</option>
                  <option value="captar">Captar Clientes</option>
                  <option value="humanizar">Humanizar / Bastidores</option>
                  <option value="autoridade">Mostrar Autoridade</option>
                </select>
              </div>
            </div>
            <div style="margin-bottom:16px">
              <label style="font-size:13px;color:var(--muted);display:block;margin-bottom:8px">Formato do post</label>
              <div class="format-options">
                <div class="format-btn selected" onclick="selectFormat(this,'carrossel')">ğŸ“± Carrossel</div>
                <div class="format-btn" onclick="selectFormat(this,'reels')">ğŸ¬ Reels (roteiro)</div>
                <div class="format-btn" onclick="selectFormat(this,'estatico')">ğŸ–¼ï¸ EstÃ¡tico</div>
                <div class="format-btn" onclick="selectFormat(this,'stories')">ğŸ“– Stories</div>
              </div>
            </div>
            <div class="form-group">
              <label>Contexto extra (opcional)</label>
              <textarea class="form-control" id="postContext" rows="2" placeholder="Ex: Quero mencionar um caso recente que viralizou..."></textarea>
            </div>
            <button class="gen-btn" id="genBtn" onclick="generatePost()">
              âœ¦ Gerar Post Agora
            </button>
          </div>
          <div id="postOutput"></div>
        </div>

        <!-- â”€â”€ RANKING â”€â”€ -->
        <div class="main-tab" id="tab-ranking">
          <div class="section-header">
            <div class="section-title">MissÃµes & Ranking</div>
            <div class="section-sub">Complete missÃµes, ganhe XP e evolua seu nÃ­vel de autoridade</div>
          </div>
          <!-- LEVEL TRACK -->
          <div style="background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:24px;margin-bottom:24px;overflow-x:auto">
            <div style="font-family:'Syne',sans-serif;font-size:15px;font-weight:800;margin-bottom:20px">Trilha de EvoluÃ§Ã£o</div>
            <div class="levels-track">
              <div class="level-node done"><div class="level-circle">ğŸŒ±</div><div class="level-name">Iniciante</div></div>
              <div class="level-connector"></div>
              <div class="level-node current"><div class="level-circle">â­</div><div class="level-name">Ativo</div></div>
              <div class="level-connector"></div>
              <div class="level-node"><div class="level-circle">ğŸ”¥</div><div class="level-name">Crescendo</div></div>
              <div class="level-connector"></div>
              <div class="level-node"><div class="level-circle">ğŸ’</div><div class="level-name">Autoridade</div></div>
              <div class="level-connector"></div>
              <div class="level-node"><div class="level-circle">ğŸ‘‘</div><div class="level-name">ReferÃªncia</div></div>
            </div>
          </div>
          <div style="background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:24px;margin-bottom:24px">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
              <div style="font-family:'Syne',sans-serif;font-size:15px;font-weight:800">Seu XP Total</div>
              <div style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:var(--gold)" id="totalXp">150 XP</div>
            </div>
            <div class="xp-bar-wrap" style="height:10px"><div class="xp-bar" id="bigXpBar" style="width:15%"></div></div>
            <div style="display:flex;justify-content:space-between;font-size:12px;color:var(--muted);margin-top:8px"><span>â­ Ativo</span><span>850 XP para ğŸ”¥ Crescendo</span></div>
          </div>
          <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:800;margin-bottom:16px">ğŸ¯ MissÃµes da Semana</div>
          <div class="missions-grid" id="missionsGrid"></div>
        </div>

        <!-- â”€â”€ SEO â”€â”€ -->
        <div class="main-tab" id="tab-seo">
          <div class="section-header">
            <div class="section-title">SEO no Google</div>
            <div class="section-sub">ApareÃ§a quando alguÃ©m buscar pelo seu serviÃ§o na sua cidade</div>
          </div>
          <div class="seo-cards" id="seoCards"></div>
        </div>

        <!-- â”€â”€ TENDÃŠNCIAS â”€â”€ -->
        <div class="main-tab" id="tab-trends">
          <div class="section-header">
            <div class="section-title">Radar de TendÃªncias</div>
            <div class="section-sub">O que estÃ¡ bombando no digital para profissionais liberais</div>
          </div>
          <div id="trendsList"></div>
        </div>

        <!-- â”€â”€ CONFIG â”€â”€ -->
        <div class="main-tab" id="tab-config">
          <div class="section-header">
            <div class="section-title">âš™ï¸ Chave de API OpenAI</div>
            <div class="section-sub">Configure sua chave para ativar a geraÃ§Ã£o de conteÃºdo com IA real</div>
          </div>
          <div class="api-setup">
            <div class="api-title">ğŸ”‘ Como obter sua chave de API</div>
            <div class="api-desc">VocÃª precisa de uma conta na OpenAI para usar a IA do InstaPro. Ã‰ rÃ¡pido e vocÃª recebe crÃ©ditos gratuitos para comeÃ§ar.</div>
            <div class="api-steps">
              <div class="api-step"><div class="api-step-num">1</div><div class="api-step-text">Acesse <a href="https://platform.openai.com" target="_blank">platform.openai.com</a> e crie uma conta gratuita com seu e-mail.</div></div>
              <div class="api-step"><div class="api-step-num">2</div><div class="api-step-text">No menu do canto superior direito, clique em <strong>API Keys</strong> â†’ <strong>Create new secret key</strong>.</div></div>
              <div class="api-step"><div class="api-step-num">3</div><div class="api-step-text">Copie a chave gerada (comeÃ§a com <code style="color:var(--accent)">sk-...</code>) e cole no campo abaixo.</div></div>
              <div class="api-step"><div class="api-step-num">4</div><div class="api-step-text">Adicione um mÃ©todo de pagamento (cartÃ£o). O custo Ã© muito baixo â€” em torno de R$ 0,05 por post gerado.</div></div>
            </div>
            <div class="api-key-input-wrap">
              <input class="form-control" type="password" id="apiKeyInput" placeholder="sk-proj-..." />
              <button class="save-api-btn" onclick="saveApiKey()">Salvar</button>
            </div>
            <div class="api-status" id="apiStatus">
              <div class="status-dot missing"></div> <span id="apiStatusText">Nenhuma chave configurada</span>
            </div>
          </div>
        </div>

      </div><!-- /main-content -->
    </div><!-- /dash-body -->

    <!-- MOBILE NAV -->
    <div class="mobile-nav">
      <button class="mobile-nav-item active" onclick="switchTab('diagnostico',this,true)"><span class="mobile-nav-icon">ğŸ”</span>DiagnÃ³stico</button>
      <button class="mobile-nav-item" onclick="switchTab('posts',this,true)"><span class="mobile-nav-icon">âœï¸</span>Posts</button>
      <button class="mobile-nav-item" onclick="switchTab('ranking',this,true)"><span class="mobile-nav-icon">ğŸ†</span>MissÃµes</button>
      <button class="mobile-nav-item" onclick="switchTab('seo',this,true)"><span class="mobile-nav-icon">ğŸ”</span>SEO</button>
      <button class="mobile-nav-item" onclick="switchTab('config',this,true)"><span class="mobile-nav-icon">âš™ï¸</span>API</button>
    </div>
  </div><!-- /dashboard -->

</div><!-- /app -->

<!-- TOAST -->
<div class="toast" id="toast">
  <span id="toastIcon">âœ“</span>
  <span id="toastMsg">Copiado!</span>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const state = {
  profession: '', instagram: '', city: '',
  areas: [], tone: 'educativo', clientAge: '', clientProblem: '',
  followers: '', frequency: '', bio: 'nao',
  apiKey: localStorage.getItem('instapro_apikey') || '',
  xp: 150,
  missions: [],
  selectedFormat: 'carrossel'
};

// Areas by profession
const areasByProfession = {
  advogado: ['Direito Civil', 'Direito de FamÃ­lia', 'Direito Trabalhista', 'Direito Criminal', 'Direito do Consumidor', 'DivÃ³rcio', 'InventÃ¡rio', 'Direito Empresarial', 'IndenizaÃ§Ãµes'],
  dentista: ['ClÃ­nica Geral', 'Ortodontia', 'Implante DentÃ¡rio', 'EstÃ©tica Dental', 'Clareamento', 'Odontopediatria', 'Periodontia', 'PrÃ³tese DentÃ¡ria'],
  psicologo: ['Ansiedade', 'DepressÃ£o', 'Relacionamentos', 'Autoestima', 'TCC', 'Psicologia Infantil', 'Terapia de Casal', 'Burnout'],
  nutricionista: ['Emagrecimento', 'Ganho de Massa', 'NutriÃ§Ã£o Esportiva', 'ReeducaÃ§Ã£o Alimentar', 'NutriÃ§Ã£o Funcional', 'Gestantes', 'Patologias'],
  medico: ['ClÃ­nica Geral', 'Medicina Preventiva', 'Dermatologia', 'Cardiologia', 'Pediatria', 'Ginecologia', 'Ortopedia'],
  fisioterapeuta: ['ReabilitaÃ§Ã£o', 'Pilates', 'RPG', 'Dor CrÃ´nica', 'Esportiva', 'PÃ³s-operatÃ³rio', 'NeurolÃ³gica'],
  arquiteto: ['Residencial', 'Comercial', 'Interiores', 'Projetos SustentÃ¡veis', 'Reformas', 'Paisagismo'],
  contador: ['Abertura de Empresa', 'Imposto de Renda', 'MEI', 'Planejamento TributÃ¡rio', 'Folha de Pagamento', 'BPO Financeiro'],
  engenheiro: ['ConstruÃ§Ã£o Civil', 'Laudos', 'Projetos Estruturais', 'ElÃ©trica', 'HidrÃ¡ulica', 'Vistoria'],
  coach: ['LideranÃ§a', 'Carreira', 'Vida', 'FinanÃ§as', 'Relacionamentos', 'Alta Performance'],
  outro: ['Marketing Pessoal', 'ConteÃºdo', 'Branding', 'Empreendedorismo', 'Produtividade']
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function goToOnboarding() {
  showScreen('onboarding');
}

function switchTab(name, el, isMobile) {
  document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
  document.getElementById('tab-' + name).classList.add('active');
  if (isMobile) {
    document.querySelectorAll('.mobile-nav-item').forEach(i => i.classList.remove('active'));
  } else {
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
  }
  el.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ONBOARDING STEPS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function nextStep(n) {
  if (n === 2) {
    state.profession = document.getElementById('profession').value;
    state.instagram = document.getElementById('instagram').value;
    state.city = document.getElementById('city').value;
    if (!state.profession) { showToast('âš ï¸ Selecione sua profissÃ£o', true); return; }
    populateAreas();
  }
  if (n === 3) {
    if (state.areas.length === 0) { showToast('âš ï¸ Selecione ao menos uma Ã¡rea', true); return; }
  }
  if (n === 4) {
    state.clientAge = document.getElementById('clientAge').value;
    state.clientProblem = document.getElementById('clientProblem').value;
  }
  document.querySelectorAll('.onboard-step').forEach(s => s.classList.remove('active'));
  document.getElementById('step' + n).classList.add('active');
  updateStepDots(n);
}

function updateStepDots(current) {
  for (let i = 1; i <= 4; i++) {
    const d = document.getElementById('sd' + i);
    d.className = 'step-dot';
    if (i < current) d.classList.add('done');
    if (i === current) d.classList.add('active');
  }
}

function populateAreas() {
  const grid = document.getElementById('areasGrid');
  grid.innerHTML = '';
  const areas = areasByProfession[state.profession] || areasByProfession.outro;
  areas.forEach(a => {
    const btn = document.createElement('div');
    btn.className = 'tag-btn';
    btn.textContent = a;
    btn.onclick = () => {
      btn.classList.toggle('selected');
      const idx = state.areas.indexOf(a);
      if (idx === -1) state.areas.push(a);
      else state.areas.splice(idx, 1);
    };
    grid.appendChild(btn);
  });
}

function selectTone(el, tone) {
  document.querySelectorAll('#toneGrid .tag-btn').forEach(b => b.classList.remove('selected'));
  el.classList.add('selected');
  state.tone = tone;
}

function selectBio(el, val) {
  document.querySelectorAll('#bioGrid .tag-btn').forEach(b => b.classList.remove('selected'));
  el.classList.add('selected');
  state.bio = val;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ANALYSIS ANIMATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startAnalysis() {
  state.followers = document.getElementById('followers').value;
  state.frequency = document.getElementById('frequency').value;
  showScreen('analyzing');
  const steps = ['as1','as2','as3','as4','as5'];
  let i = 0;
  function tick() {
    if (i > 0) {
      const prev = document.getElementById(steps[i-1]);
      prev.classList.remove('active');
      prev.classList.add('done');
      prev.querySelector('.step-check').textContent = 'âœ“';
    }
    if (i < steps.length) {
      document.getElementById(steps[i]).classList.add('active');
      i++;
      setTimeout(tick, 900);
    } else {
      setTimeout(() => {
        document.getElementById(steps[steps.length-1]).classList.remove('active');
        document.getElementById(steps[steps.length-1]).classList.add('done');
        document.getElementById(steps[steps.length-1]).querySelector('.step-check').textContent = 'âœ“';
        buildDashboard();
        showScreen('dashboard');
      }, 600);
    }
  }
  tick();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BUILD DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildDashboard() {
  // Topbar
  const ig = state.instagram || '@profissional';
  document.getElementById('topbarUser').textContent = ig;
  document.getElementById('userAvatar').textContent = (ig[1] || 'P').toUpperCase();
  document.getElementById('diagSub').textContent = `AnÃ¡lise de ${ig} â€” ${state.profession}`;

  // Score
  const score = calcScore();
  animateScore(score);

  // Metrics
  buildMetrics();

  // Tips
  buildTips();

  // Missions
  buildMissions();

  // SEO
  buildSeo();

  // Trends
  buildTrends();

  // API key status
  updateApiStatus();
}

function calcScore() {
  let s = 20;
  if (state.bio === 'sim') s += 20;
  else if (state.bio === 'parcial') s += 10;
  if (state.frequency === 'diario') s += 20;
  else if (state.frequency === 'semanal') s += 12;
  else if (state.frequency === 'mensal') s += 4;
  if (state.followers !== '0-100') s += 10;
  if (state.areas.length >= 3) s += 10;
  if (state.tone) s += 5;
  if (state.city) s += 5;
  return Math.min(s, 78); // cap for demo
}

function animateScore(score) {
  const circle = document.getElementById('scoreCircle');
  const numEl = document.getElementById('scoreNum');
  const circumference = 326.7;
  let current = 0;
  const interval = setInterval(() => {
    current = Math.min(current + 1, score);
    numEl.innerHTML = `${current}<span>/ 100</span>`;
    const offset = circumference - (current / 100) * circumference;
    circle.style.strokeDashoffset = offset;
    if (current >= score) clearInterval(interval);
  }, 25);

  const desc = score < 35
    ? 'Seu perfil estÃ¡ em estÃ¡gio inicial. Com as aÃ§Ãµes certas, vocÃª pode triplicar esse score em 30 dias.'
    : score < 55
    ? 'VocÃª tem uma base, mas ainda falta consistÃªncia e posicionamento claro. As dicas abaixo sÃ£o o caminho.'
    : 'Bom comeÃ§o! Agora Ã© hora de escalar com conteÃºdo estratÃ©gico e presenÃ§a fora do Instagram.';
  document.getElementById('scoreDesc').textContent = desc;
}

function buildMetrics() {
  const bioMap = { sim: ['Otimizada', 'badge-green'], parcial: ['Incompleta', 'badge-yellow'], nao: ['Ausente', 'badge-red'] };
  const freqMap = { diario: ['DiÃ¡ria', 'badge-green'], semanal: ['Semanal', 'badge-yellow'], mensal: ['Rara', 'badge-red'], nunca: ['Inexistente', 'badge-red'] };
  document.getElementById('metrBio').textContent = bioMap[state.bio][0];
  document.getElementById('metrBioB').textContent = bioMap[state.bio][0];
  document.getElementById('metrBioB').className = 'metric-badge ' + bioMap[state.bio][1];
  document.getElementById('metrFreq').textContent = freqMap[state.frequency][0];
  document.getElementById('metrFreqB').textContent = freqMap[state.frequency][0];
  document.getElementById('metrFreqB').className = 'metric-badge ' + freqMap[state.frequency][1];
  document.getElementById('metrFollow').textContent = state.followers;
  document.getElementById('metrFollowB').textContent = state.followers === '5000+' ? 'ğŸ”¥ Ã“timo' : 'Crescendo';
  document.getElementById('metrFollowB').className = 'metric-badge ' + (state.followers === '5000+' ? 'badge-green' : 'badge-yellow');
  document.getElementById('metrNiche').textContent = profLabel(state.profession);
}

function profLabel(p) {
  const m = {advogado:'Direito',dentista:'Odonto',psicologo:'Psico',nutricionista:'Nutri',medico:'Medicina',fisioterapeuta:'Fisio',arquiteto:'Arq.',contador:'Contab.',engenheiro:'Eng.',coach:'Coach',outro:'Outro'};
  return m[p] || p;
}

function buildTips() {
  const tips = getTips();
  const list = document.getElementById('tipsList');
  list.innerHTML = '';
  tips.forEach(t => {
    list.innerHTML += `<div class="tip-item">
      <div class="tip-priority priority-${t.p}"></div>
      <div><div class="tip-title">${t.title}</div><div class="tip-desc">${t.desc}</div></div>
    </div>`;
  });
}

function getTips() {
  const tips = [];
  const p = state.profession;
  if (state.bio !== 'sim') tips.push({ p:'high', title:'ğŸ”§ Reescreva sua bio profissional', desc:`Sua bio precisa responder em 3 segundos: quem vocÃª Ã©, o que resolve e onde atende. Ex: "${profLabel(p)} em ${state.city || 'sua cidade'} | ${state.areas[0] || 'sua especialidade'} | ğŸ“² DM para consulta"` });
  if (state.frequency === 'nunca' || state.frequency === 'mensal') tips.push({ p:'high', title:'ğŸ“… Crie uma agenda mÃ­nima de posts', desc:'Poste pelo menos 3 vezes por semana. ConsistÃªncia vale mais que qualidade perfeita. Comece com 1 dica Ãºtil, 1 bastidor e 1 depoimento (quando tiver).' });
  tips.push({ p:'med', title:'ğŸ  Invista em CarrossÃ©is educativos', desc:`CarrossÃ©is tÃªm 3x mais salvamentos que posts estÃ¡ticos. Uma ideia fÃ¡cil: "5 dÃºvidas que todo ${p} responde toda semana" â€” direto, Ãºtil, salvÃ¡vel.` });
  tips.push({ p:'med', title:'ğŸ“² Adicione um CTA em todo post', desc:'Cada legenda deve terminar com uma aÃ§Ã£o: "Salva esse post", "Manda DM", "Comenta sua dÃºvida". Sem CTA, o algoritmo e o cliente ficam em dÃºvida.' });
  if (state.city) tips.push({ p:'low', title:`ğŸ“ Use localizaÃ§Ã£o em todos os posts`, desc:`Marque "${state.city}" toda vez que postar. Isso aumenta sua visibilidade para pessoas da regiÃ£o buscando ${p} perto delas.` });
  tips.push({ p:'low', title:'ğŸ¤ Parcerias estratÃ©gicas via Instagram', desc:`Encontre profissionais complementares (ex: ${p === 'advogado' ? 'contador + psicÃ³logo' : p === 'dentista' ? 'nutricionista + mÃ©dico' : 'advogado + contador'}) e faÃ§am posts colaborativos. Alcance dobrado, zero custo.` });
  return tips;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MISSIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildMissions() {
  state.missions = [
    { id:'m1', icon:'ğŸ“', title:'Otimize sua bio', desc:'Reescreva sua bio seguindo a fÃ³rmula: Quem vocÃª Ã© + O que resolve + Onde + CTA.', xp:50, done:false },
    { id:'m2', icon:'ğŸ“¸', title:'Poste 3 vezes esta semana', desc:'ConsistÃªncia Ã© tudo. 3 posts em 7 dias â€” pode ser carrossel, stories ou reels.', xp:80, done:false },
    { id:'m3', icon:'ğŸ¬', title:'Grave seu primeiro Reels', desc:'30 segundos respondendo a dÃºvida mais comum que vocÃª recebe. Simples e poderoso.', xp:100, done:false },
    { id:'m4', icon:'ğŸ’¬', title:'Responda todos os comentÃ¡rios', desc:'Por 7 dias, responda 100% dos comentÃ¡rios em atÃ© 1h. O algoritmo vai amar vocÃª.', xp:60, done:false },
    { id:'m5', icon:'ğŸ”‘', title:'Configure o Google Meu NegÃ³cio', desc:'Crie ou otimize seu perfil no Google â€” Ã© gratuito e atrai clientes locais.', xp:120, done:false },
    { id:'m6', icon:'ğŸ“Š', title:'Crie um carrossel com dicas', desc:`Liste "5 dÃºvidas que um ${profLabel(state.profession)} responde toda semana". Salve e engaje.`, xp:70, done:false },
  ];
  renderMissions();
}

function renderMissions() {
  const grid = document.getElementById('missionsGrid');
  grid.innerHTML = '';
  state.missions.forEach(m => {
    grid.innerHTML += `<div class="mission-card ${m.done?'done':''}" id="mc-${m.id}">
      <div class="mission-header">
        <div class="mission-icon">${m.icon}</div>
        <div class="mission-xp">+${m.xp} XP</div>
      </div>
      <div class="mission-title">${m.title}</div>
      <div class="mission-desc">${m.desc}</div>
      <button class="mission-check-btn" onclick="completeMission('${m.id}')">${m.done ? 'âœ… ConcluÃ­da!' : 'âœ“ Marcar como feita'}</button>
    </div>`;
  });
}

function completeMission(id) {
  const m = state.missions.find(x => x.id === id);
  if (!m || m.done) return;
  m.done = true;
  state.xp += m.xp;
  updateXp();
  renderMissions();
  showToast(`ğŸ‰ +${m.xp} XP! ${m.title} concluÃ­da!`);
}

function updateXp() {
  const levels = [
    { name:'ğŸŒ± Iniciante', min:0, max:300 },
    { name:'â­ Ativo', min:300, max:700 },
    { name:'ğŸ”¥ Crescendo', min:700, max:1300 },
    { name:'ğŸ’ Autoridade', min:1300, max:2000 },
    { name:'ğŸ‘‘ ReferÃªncia', min:2000, max:3000 },
  ];
  const lvl = levels.find(l => state.xp < l.max) || levels[levels.length-1];
  const pct = Math.min(((state.xp - lvl.min) / (lvl.max - lvl.min)) * 100, 100);
  document.getElementById('totalXp').textContent = state.xp + ' XP';
  document.getElementById('bigXpBar').style.width = pct + '%';
  document.getElementById('sidebarXpBar').style.width = pct + '%';
  document.getElementById('sidebarRankName').textContent = lvl.name;
  document.getElementById('sidebarXpText').textContent = `${state.xp} / ${lvl.max} XP para prÃ³ximo nÃ­vel`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SEO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildSeo() {
  const p = state.profession;
  const city = state.city || 'sua cidade';
  const area = state.areas[0] || 'sua especialidade';
  const cards = [
    {
      icon:'ğŸ—ºï¸', title:'Google Meu NegÃ³cio',
      desc:`Seu cartÃ£o de visita gratuito no Google. ApareÃ§a quando alguÃ©m buscar "${p} em ${city}". Adicione fotos, horÃ¡rios, especialidades e peÃ§a avaliaÃ§Ãµes de clientes.`,
      keywords:[`${p} em ${city}`, `${area} ${city}`, `${p} perto de mim`, `${p} ${city} avaliaÃ§Ãµes`]
    },
    {
      icon:'âœï¸', title:'ConteÃºdo para Blog / Site',
      desc:`Artigos curtos sobre dÃºvidas comuns atraem visitantes orgÃ¢nicos. Escreva posts com tÃ­tulo "Como [resolver problema] em ${city}" â€” ideal para captar clientes no Google.`,
      keywords:[`como encontrar ${p}`, `quando preciso de ${p}`, `quanto custa ${area}`, `${p} ${city} preÃ§o`]
    },
    {
      icon:'â­', title:'EstratÃ©gia de AvaliaÃ§Ãµes',
      desc:`PeÃ§a avaliaÃ§Ã£o para cada cliente atendido. 10 avaliaÃ§Ãµes com 5 estrelas te colocam no topo das buscas locais. Envie uma mensagem no WhatsApp com o link direto.`,
      keywords:['google avaliaÃ§Ãµes','google meu negÃ³cio nota','como subir no google','avaliaÃ§Ãµes 5 estrelas']
    },
    {
      icon:'ğŸ“±', title:'Instagram como SEO',
      desc:`Use palavras-chave no seu nome de usuÃ¡rio e bio do Instagram. "Dr. JoÃ£o | ${profLabel(p)} ${city}" aparece nas buscas. Posts com localizaÃ§Ã£o marcada amplificam isso.`,
      keywords:[`@${p}${city.toLowerCase().replace(/\s/g,'')}`,`${area} ${city}`,`profissional ${city}`,`${p} recomendado`]
    },
  ];
  const div = document.getElementById('seoCards');
  div.innerHTML = '';
  cards.forEach(c => {
    div.innerHTML += `<div class="seo-card">
      <div class="seo-card-icon">${c.icon}</div>
      <div class="seo-card-title">${c.title}</div>
      <div class="seo-card-desc">${c.desc}</div>
      <div class="seo-keywords">${c.keywords.map(k=>`<span class="seo-kw">${k}</span>`).join('')}</div>
    </div>`;
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TRENDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildTrends() {
  const trends = [
    { rank:1, name:'CarrossÃ©is "5 erros que vocÃª comete ao..."', desc:'Formato mais salvo no Instagram. Profissionais que usam esse modelo ganham 4x mais seguidores qualificados.', heat:'ğŸ”¥ğŸ”¥ğŸ”¥ MÃ¡ximo' },
    { rank:2, name:'Reels educativos de 30-60 segundos', desc:'O algoritmo prioriza vÃ­deos curtos. Responder 1 dÃºvida comum da sua Ã¡rea em 45s Ã© ouro.', heat:'ğŸ”¥ğŸ”¥ğŸ”¥ MÃ¡ximo' },
    { rank:3, name:'Bastidores da profissÃ£o ("um dia na vida")', desc:'Humaniza o profissional, gera conexÃ£o e curiosidade. Muito compartilhado por clientes potenciais.', heat:'ğŸ”¥ğŸ”¥ Alto' },
    { rank:4, name:'Posts de "mito vs realidade"', desc:`"Mito: ${state.profession === 'advogado' ? 'advogado caro Ã© sempre melhor' : 'plano de saÃºde cobre tudo'}. Realidade: ..." â€” gera debate e engajamento.`, heat:'ğŸ”¥ğŸ”¥ Alto' },
    { rank:5, name:'Depoimentos em formato de histÃ³ria', desc:'TransformaÃ§Ãµes reais de clientes (anonimizadas se necessÃ¡rio) tÃªm altÃ­ssima taxa de salvamento e compartilhamento.', heat:'ğŸ”¥ğŸ”¥ Alto' },
    { rank:6, name:'SEO no Instagram (bio + nome otimizados)', desc:'Profissionais que otimizam nome de usuÃ¡rio e bio para busca ganham 30% mais alcance orgÃ¢nico.', heat:'ğŸ”¥ Crescendo' },
    { rank:7, name:'Lives de perguntas e respostas', desc:'Posiciona autoridade em tempo real, gera salvamentos e pode ser repurposado em posts.', heat:'ğŸ”¥ Crescendo' },
  ];
  const div = document.getElementById('trendsList');
  div.innerHTML = '';
  trends.forEach(t => {
    div.innerHTML += `<div class="trend-item">
      <div class="trend-rank">${String(t.rank).padStart(2,'0')}</div>
      <div class="trend-info">
        <div class="trend-name">${t.name}</div>
        <div class="trend-desc">${t.desc}</div>
      </div>
      <div class="trend-heat">${t.heat}</div>
    </div>`;
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  POST GENERATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function selectFormat(el, fmt) {
  document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('selected'));
  el.classList.add('selected');
  state.selectedFormat = fmt;
}

async function generatePost() {
  const tema = document.getElementById('postTema').value.trim();
  if (!tema) { showToast('âš ï¸ Digite o tema do post', true); return; }
  const objetivo = document.getElementById('postObjetivo').value;
  const context = document.getElementById('postContext').value.trim();
  const btn = document.getElementById('genBtn');
  btn.disabled = true;
  btn.textContent = 'â³ Gerando...';

  const apiKey = state.apiKey;
  if (apiKey) {
    await generateWithOpenAI(tema, objetivo, context, btn);
  } else {
    // DEMO fallback
    setTimeout(() => {
      showGeneratedPost(getDemoPost(tema, objetivo), btn);
    }, 1500);
  }
}

async function generateWithOpenAI(tema, objetivo, context, btn) {
  const systemPrompt = `VocÃª Ã© um especialista em marketing digital para profissionais liberais.
O usuÃ¡rio Ã© um(a) ${state.profession} que atua com ${state.areas.join(', ')} em ${state.city || 'Brasil'}.
Tom de voz: ${state.tone}. Cliente ideal: ${state.clientAge} anos.
Crie posts altamente engajadores, prÃ¡ticos e que transmitem autoridade.`;

  const userPrompt = `Crie um post completo para Instagram no formato ${state.selectedFormat}.
Tema: ${tema}
Objetivo: ${objetivo}
Contexto extra: ${context || 'nenhum'}

Retorne APENAS um JSON com esta estrutura (sem markdown, sem explicaÃ§Ã£o):
{
  "titulo": "tÃ­tulo chamativo do post",
  "legenda": "legenda completa com quebras de linha, emojis e CTA ao final",
  "hashtags": ["hashtag1", "hashtag2", ...] (15 hashtags relevantes),
  "dica_extra": "uma dica de quando/como postar esse conteÃºdo"
}`;

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        system: systemPrompt,
        messages: [{ role: 'user', content: userPrompt }]
      })
    });
    const data = await response.json();
    const text = data.content?.[0]?.text || '';
    let parsed;
    try {
      parsed = JSON.parse(text.replace(/```json|```/g, '').trim());
    } catch {
      parsed = { titulo: tema, legenda: text, hashtags: [], dica_extra: '' };
    }
    showGeneratedPost(parsed, btn);
  } catch (err) {
    // Try OpenAI fallback if user has OpenAI key
    if (state.apiKey.startsWith('sk-')) {
      await generateWithOpenAIKey(tema, objetivo, context, btn, systemPrompt, userPrompt);
    } else {
      showGeneratedPost(getDemoPost(tema, objetivo), btn);
      showToast('âš ï¸ Erro na API. Mostrando demo.', true);
    }
  }
}

async function generateWithOpenAIKey(tema, objetivo, context, btn, systemPrompt, userPrompt) {
  try {
    const response = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${state.apiKey}`
      },
      body: JSON.stringify({
        model: 'gpt-4o-mini',
        messages: [
          { role: 'system', content: systemPrompt },
          { role: 'user', content: userPrompt }
        ]
      })
    });
    const data = await response.json();
    const text = data.choices?.[0]?.message?.content || '';
    let parsed;
    try {
      parsed = JSON.parse(text.replace(/```json|```/g, '').trim());
    } catch {
      parsed = { titulo: tema, legenda: text, hashtags: [], dica_extra: '' };
    }
    showGeneratedPost(parsed, btn);
  } catch {
    showGeneratedPost(getDemoPost(tema, objetivo), btn);
    showToast('âš ï¸ Erro na API OpenAI. Verifique sua chave.', true);
  }
}

function getDemoPost(tema, objetivo) {
  const prof = state.profession;
  const area = state.areas[0] || tema;
  return {
    titulo: `5 coisas que todo ${profLabel(prof)} precisa saber sobre ${tema}`,
    legenda: `ğŸ“Œ VocÃª sabia que a maioria das pessoas nunca soube isso sobre ${tema}?\n\nComo ${profLabel(prof)}, vejo isso acontecer toda semana:\n\n1ï¸âƒ£ Muitos desconhecem seus direitos\n2ï¸âƒ£ Agem tarde demais por falta de informaÃ§Ã£o\n3ï¸âƒ£ Tomam decisÃµes sem orientaÃ§Ã£o adequada\n\nÃ‰ por isso que decidi trazer esse conteÃºdo hoje.\n\nâœ… Salva esse post para consultar quando precisar.\n\nğŸ’¬ VocÃª tem dÃºvidas sobre ${tema}? Me conta nos comentÃ¡rios â€” leio todos!\n\nğŸ“² Me chama no direct para uma conversa sem compromisso.`,
    hashtags: [`#${prof}`, `#${area.toLowerCase().replace(/\s/g,'')}`, `#${state.city?.toLowerCase().replace(/\s/g,'') || 'brasil'}`, '#profissionalliberal', '#marketingdigital', '#instagramprofissional', '#dicasprofissionais', '#autoridade', '#conteudoprofissional', '#carrossel', '#dicas', '#aprendascomigo', '#vida${prof}', '#comunicacao', '#posicionamento'],
    dica_extra: `ğŸ’¡ Poste na terÃ§a, quarta ou quinta entre 18h e 21h. Use os primeiros 3 slides para criar curiosidade antes de entregar a resposta.`
  };
}

function showGeneratedPost(post, btn) {
  btn.disabled = false;
  btn.textContent = 'âœ¦ Gerar Post Agora';
  const output = document.getElementById('postOutput');
  const hashtags = (post.hashtags || []).map(h => `<span class="hashtag">${h.startsWith('#')?h:'#'+h}</span>`).join('');
  output.innerHTML = `<div class="post-card">
    <div class="post-card-header">
      <span class="post-type-badge">ğŸ“± ${state.selectedFormat.charAt(0).toUpperCase() + state.selectedFormat.slice(1)}</span>
      <button class="post-copy-btn" onclick="copyPost(this)">ğŸ“‹ Copiar legenda</button>
    </div>
    <div style="font-family:'Syne',sans-serif;font-size:16px;font-weight:800;margin-bottom:12px">${post.titulo || ''}</div>
    <div class="post-content-area" id="postLegenda">${post.legenda || ''}</div>
    <div class="hashtag-cloud">${hashtags}</div>
    ${post.dica_extra ? `<div style="margin-top:14px;padding:12px;background:rgba(92,248,212,0.05);border:1px solid rgba(92,248,212,0.15);border-radius:10px;font-size:13px;color:var(--accent3)">${post.dica_extra}</div>` : ''}
  </div>`;
  showToast('âœ¨ Post gerado com sucesso!');
  // Add XP
  state.xp += 20;
  updateXp();
}

function copyPost(btn) {
  const text = document.getElementById('postLegenda').textContent;
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'âœ… Copiado!';
    setTimeout(() => btn.textContent = 'ğŸ“‹ Copiar legenda', 2000);
    showToast('ğŸ“‹ Legenda copiada!');
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  API KEY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveApiKey() {
  const key = document.getElementById('apiKeyInput').value.trim();
  if (!key) { showToast('âš ï¸ Cole sua chave de API', true); return; }
  state.apiKey = key;
  localStorage.setItem('instapro_apikey', key);
  updateApiStatus();
  showToast('ğŸ”‘ Chave salva com sucesso!');
}

function updateApiStatus() {
  const hasKey = !!state.apiKey;
  const dot = document.querySelector('#apiStatus .status-dot');
  const txt = document.getElementById('apiStatusText');
  if (hasKey) {
    dot.className = 'status-dot ok';
    txt.textContent = 'Chave de API configurada âœ“';
  } else {
    dot.className = 'status-dot missing';
    txt.textContent = 'Nenhuma chave configurada';
  }
  ['apiWarningDiag','apiWarningPost'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.className = hasKey ? 'api-warning hidden' : 'api-warning';
  });
  if (state.apiKey) {
    document.getElementById('apiKeyInput').value = state.apiKey;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, isError) {
  const t = document.getElementById('toast');
  document.getElementById('toastMsg').textContent = msg;
  t.style.borderColor = isError ? 'rgba(252,92,125,0.3)' : 'rgba(92,248,212,0.3)';
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
  if (state.apiKey) updateApiStatus();
});
</script>
</body>
</html>
